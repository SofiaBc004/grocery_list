# ğŸ›’ Grocery List App #

## Project Overview ##

This Grocery List App is a minimal software application built with FastAPI and SQLite.
It allows users to manage their grocery list through a RESTful API, supporting operations such as:
- Add new grocery items
- View all items
- Update item details
- Mark items as purchased
- Delete items

This project was developed as part of the DevOps Pipeline Design assignment, following the Software Development Life Cycle (SDLC) approach. It includes a fully automated CI/CD DevOps pipeline with monitoring and cloud deployment.


ğŸŒ Live Application

Azure Web App:
``` 
https://sofia-grocerylist-hyccc2e2a5c0e7fb.spaincentral-01.azurewebsites.net/
``` 

## Tech Stack ##

- **Backend:** Python (FastAPI)
- **Database:** SQLite
   The application uses a SQLite database stored inside the Docker container.

   On Azure Web App, container storage is ephemeral, meaning the database resets when the container restarts or redeploys.
   For production, Azure SQL or a persistent volume would be required.
- **Frontend:** HTML + JavaScript 
- **Testing:** Pytest + pytest-cov
- **CI:** GitHub Actions
- **Monitoring:** Prometheus + Grafana (via Docker)


## Setup Instructions ##
1. Clone the repository

`git clone https://github.com/SofiaBc004/grocery_list.git`

2. Create and activate a virtual environment

``` 
python3 -m venv venv
source venv/bin/activate    # Mac/Linux
venv\Scripts\activate       # Windows 
```

3. Install dependencies

`pip install -r requirements.txt`

4. Run the application

`uvicorn app.main:app --reload`

5. Access the API
- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc


## Testing and Coverage ##
This project includes unit and integration tests, with ~90% coverage.

Run tests:
``` 
pytest
``` 
Run tests with coverage:
``` 
pytest --cov=app --cov-report=term --cov-report=html
``` 

This will generate:
- A terminal coverage report
- An HTML report at htmlcov/index.html


## Continuous Integration (CI) ##
The project uses GitHub Actions to automatically run:
- Dependency installation
- Tests
- Coverage threshold enforcement (--cov-fail-under=70)
- A basic build check (python -m compileall app)

CI runs on:
- Every push to main
- Every Pull Request targeting main

Find the workflow in:

.github/workflows/ci.yml


## Cloud Deployment (CD) â€” Azure Web App ##
This project includes a full Continuous Deployment pipeline using GitHub Actions and Azure Web App for Containers.


Deployment Workflow


On every push to the main branch:
1. Tests + coverage are executed.
2. A Docker image of the application is built.
3. The image is pushed to Docker Hub:
``` 
sofiabc004/grocery-app:latest
``` 
4. Azure Web App automatically pulls the updated image.
5. The container is started on port 80.

Azure Configuration
- Hosting: Azure Web App for Containers
- Registry: Docker Hub
- Image: ``` sofiabc004/grocery-app:latest ``` 
- Port: 80
- Frontend: served directly by FastAPI from ``` /frontend/index.html ``` 

Secrets Used
```
- DOCKERHUB_USERNAME
- DOCKERHUB_TOKEN
- AZURE_CREDENTIALS 
``` 

Workflow File
``` .github/workflows/azure-cd.yml ```


## ğŸ“ˆ Monitoring (Prometheus + Grafana) ##
The app exposes two monitoring endpoints:
- /health â†’ basic application status
- /metrics â†’ Prometheus-formatted metrics (requests, latency, errors)

ğŸ”§ 1. Start the FastAPI app
``` 
uvicorn app.main:app --reload
``` 

ğŸ³ 2. Start Prometheus + Grafana (Docker)
``` 
docker compose up
``` 

This launches:
| Service     | URL                      |
|-------------|--------------------------|
| Prometheus  | http://localhost:9090    |
| Grafana     | http://localhost:3000    |

ğŸ§­ 3. Prometheus
Prometheus scrapes: http://host.docker.internal:8000/metrics

Check target status: Status â†’ Target Health

ğŸ“Š 4. Grafana Dashboard
- Login (default):
   user: admin
   pass: admin
- Add new data source: Prometheus
- URL: http://prometheus:9090
- Create dashboard panels for:
   Total requests by status code
   95th percentile latency
   Error rate (4xx and 5xx)

** Note: ** `/metrics` is automatically generated by `prometheus_fastapi_instrumentator`.


## Frontend Instructions ##
The project also includes a simple frontend (HTML + JavaScript) that allows users to interact with the grocery list visually. The frontend is served directly by the FastAPI backend inside the Docker container.
â–¶  Local Development

1. Start the backend:
   ```
   uvicorn app.main:app --reload
   ```

2. Open your browser and go to:
     ```
     http://127.0.0.1:8000/   
     ```

â–¶  Deployed Version (Azure)

The frontend is available at the root URL of the deployed container:

     ```
     https://sofia-grocerylist-hyccc2e2a5c0e7fb.spaincentral-01.azurewebsites.net/ 
     ```

â–¶  Features in the frontend:
   - Add grocery items
   - Delete grocery items
   - Mark/unmark items as purchased
   - Items grouped by category (e.g., fruit, dairy, vegetables)
   - Search by name or ID

The frontend automatically uses the correct backend URL through window.location.origin, ensuring it works both locally and on Azure.

## Project Structure ##
```
grocery_list/
â”‚â”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py        # FastAPI entry point
â”‚   â”œâ”€â”€ models.py      # Data schema (models)
â”‚   â”œâ”€â”€ crud.py        # Database operations (CRUD)
â”‚   â”œâ”€â”€ db.py          # SQLite connection and table setup
â”‚
â”‚â”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html     # HTML + JavaScript frontend UI
â”‚â”€â”€ tests/             # Unit + integration tests
â”‚
â”‚â”€â”€ docs/              # SDLC documents (planning, requirements, design)
â”‚
â”‚â”€â”€ .github/
â”‚ â””â”€â”€ workflows/
â”‚     â”œâ”€â”€ ci.yml           # Runs tests + coverage on every push/PR
â”‚     â”œâ”€â”€ azure-cd.yml     # Builds & deploys Docker image to Azure
â”‚     â””â”€â”€ deploy.yml       # (Previous workflow, kept for reference)
â”‚
â”‚â”€â”€ docker-compose.yml # Prometheus + Grafana monitoring stack
â”‚â”€â”€ prometheus.yml     # Prometheus scrape configuration
â”‚â”€â”€ Dockerfile         # Container definition for FastAPI app
â”‚â”€â”€ requirements.txt   # Python dependencies
â”‚â”€â”€ .gitignore         # Ignored files (venv, sqlite DB, etc.)
â”‚â”€â”€ README.md          # Project documentation
â”‚â”€â”€ REPORT.md          # md version of report
â”‚â”€â”€ coverage.xml       # Test coverage report (generated)
â”‚â”€â”€ grocery.db         # SQLite DB (created at runtime; non-persistent)
```
## API Endpoints ##

| Method | Endpoint             | Description              |
|--------|----------------------|--------------------------|
| POST   | `/items`             | Create a new grocery item|
| GET    | `/items`             | Get all grocery items    |
| GET    | `/items/{id}`        | Get item by ID           |
| PATCH  | `/items/{id}`        | Update an item           |
| PATCH  | `/items/{id}/toggle` | Toggle purchased status  |
| DELETE | `/items/{id}`        | Delete an item           |
| GET    | `/health`            | App health status        |
| GET    | `/metrics`           | Prometheus metrics       |

## Future Improvements ##
- Add authentication & user accounts
- Switch from SQLite to a persistent Azure SQL database
- Add error alerts, validation, and loading states

## Author ##
Sofia Boicenco

BCSAI, 3rd Year student at IE University